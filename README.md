# HW-12.3-1

## Домашнее задание по лекции "12.3. Развертывание кластера на собственных серверах (лекция 1)"

### Задание 1: Описать требования к кластеру

Сначала проекту необходимо определить требуемые ресурсы. 
Известно, что проекту нужны база данных, система кеширования, а само приложение состоит из бекенда и фронтенда. 
Опишите, какие ресурсы нужны, если известно:

База данных должна быть отказоустойчивой. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии.

Кэш должен быть отказоустойчивый. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии.

Фронтенд обрабатывает внешние запросы быстро, отдавая статику. Потребляет не более 50 МБ ОЗУ на каждый экземпляр, 0.2 ядра. 5 копий.

Бекенд потребляет 600 МБ ОЗУ и по 1 ядру на копию. 10 копий.

По требованиям получается что БД тоже внутри кластера.

Требования к ресурсам кластера


Control plane
    ● CPU — от 2 ядер
    ● ОЗУ — от 2 ГБ
    ● Диск — от 50 ГБ

Рабочая нода
    ● CPU — от 1 ядра
    ● ОЗУ — от 1 ГБ
    ● Диск — от 100 ГБ



1. Сначала сделайте расчет всех необходимых ресурсов.


Суммарные ресурсы на приложения кластера:

    CPU  3ядра + 3ядра + 1 ядро + 10 ядер = 17 ядер

    Память 12 Гб + 12 Гб + 0,25 Гб + 6 Гб = 30,25 Гб

2. Затем прикиньте количество рабочих нод, которые справятся с такой нагрузкой.

Количечество рабочих нод предлагаю сделать 3, т.к.:

  3х нод достаточно для такой нагрузки
  позволит копии БД и кеша разнести на разные ноды

  каждая рабочая нода 6 CPU и 10,1Гб ОЗУ

3. Добавьте к полученным цифрам запас, который учитывает выход из строя как минимум одной ноды.

  каждая нода 9 CPU и 16 Гб ОЗУ с учётом запаса

4. Добавьте служебные ресурсы к нодам. Помните, что для разных типов нод требовния к ресурсам разные.


каждая рабочая нода 10 CPU и 17 Гб ОЗУ с учётом служебных ресурсов

5. Control plane на отдельной ноде и на одной из рабочей ноде
С учётом эьлгл итоговые значения следующие:

    Control plane node - CPU 2 ядра, память 2Гб Диск от 50Гб
    Рабочая нода 1 - CPU 12 ядер, память 19Гб (для поднятия второго СР) Диск от 150Гб
    Рабочая нода 2 и 3 - CPU 10 ядер, память 17Гб диск от 100Гб

Дополнительно объём дискового пространства надо добавить из требований к БД, кешу и приложений, 
этих данных нет.

В завершение 

CPU и Память - я бы предложил добавить запас 20% и сделать кратно 4м

Итого, от следующих значений:

    Control plane node - CPU 4 ядра, память 4Гб
    Рабочая нода 1 - CPU 16 ядер, память 24Гб
    Рабочая нода 2 и 3 - CPU 12 ядер, память 24Гб

Диск для каждой ноды от 250 Гб (операционная система + служебные ресурсы кластера) + требования приложений и с запасом 25%



